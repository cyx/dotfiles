#! /usr/bin/env ruby

marker = %{# Untracked files:
#   (use "git add <file>..." to include in what will be committed)}

files = `git status`.split(marker).last.split("\n").
  select { |e| e.start_with?("#") }.
  map    { |e| e.gsub(/^# */, "") }.
  reject { |e| e.to_s.strip.empty? }

files.each do |file|
  puts "clean-whitespace #{file}"
  `clean-whitespace #{file}`
end
